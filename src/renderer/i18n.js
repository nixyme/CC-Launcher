// === i18n — Internationalization Module ===
let currentLocale = 'en';

const translations = {
  en: {
    'sidebar.title': 'Projects',
    'sidebar.newProject': 'New Project (⌘N)',
    'sidebar.search': 'Search projects...',
    'welcome.title': 'CC-Launcher',
    'welcome.subtitle': 'Select a project or create a new one',
    'welcome.shortcut': 'to add project',
    'welcome.activate': 'to activate window',
    'details.edit': 'Edit',
    'details.delete': 'Delete',
    'details.projectPath': 'Project Path',
    'details.outputPath': 'Output Path',
    'details.open': 'Open',
    'details.commands': 'Commands',
    'modal.newProject': 'New Project',
    'modal.editProject': 'Edit Project',
    'modal.projectName': 'Project Name',
    'modal.projectNamePlaceholder': 'My Project',
    'modal.projectPath': 'Project Path',
    'modal.selectProjectFolder': 'Select project folder',
    'modal.browse': 'Browse',
    'modal.commands': 'Commands',
    'modal.addCommand': '+ Add Command',
    'modal.outputPath': 'Output Path',
    'modal.selectOutputFolder': 'Select output folder (optional)',
    'modal.cancel': 'Cancel',
    'modal.save': 'Save',
    'modal.browseFile': 'Browse file',
    'modal.cmdName': 'Name',
    'details.cmdName': 'Name',
    'action.run': 'Run',
    'action.runSilent': 'Run',
    'mode.terminal': 'Terminal mode',
    'mode.silent': 'Silent mode',
    'mode.clickToTerminal': 'Silent mode active — click to switch to Terminal',
    'mode.clickToSilent': 'Terminal mode active — click to switch to Silent',
    'msg.loadFailed': 'Failed to load projects',
    'msg.noMatch': 'No matching projects',
    'msg.noProjects': 'No projects yet',
    'msg.emptyCommand': 'Command cannot be empty',
    'msg.fillAllFields': 'Please fill all fields and add at least one command',
    'msg.nameRequired': 'Project name is required',
    'msg.projectUpdated': 'Project updated',
    'msg.projectAdded': 'Project added',
    'msg.saveFailed': 'Save failed',
    'msg.deleteTitle': 'Delete Project',
    'msg.deleteConfirm': 'Are you sure you want to delete "{name}"? This cannot be undone.',
    'msg.projectDeleted': 'Project deleted',
    'msg.deleteFailed': 'Delete failed',
    'msg.launching': 'Launching terminal...',
    'msg.launched': 'Command launched in terminal',
    'msg.executingSilent': 'Running silently...',
    'msg.silentComplete': 'Completed in {duration}s',
    'msg.silentFailed': 'Silent execution failed',
    'msg.execFailed': 'Execution failed',
    'msg.exportFailed': 'Export failed',
    'msg.exported': 'Settings exported',
    'msg.invalidJson': 'Invalid JSON file',
    'msg.imported': 'Imported {imported}, skipped {skipped}',
    'msg.importFailed': 'Import failed',
    'msg.minOneCommand': 'At least one command required',
    'confirm.cancel': 'Cancel',
    'confirm.delete': 'Delete',
    'sidebar.settings': 'Settings',
    'settings.title': 'Settings',
    'settings.autoLaunch': 'Launch at startup',
    'settings.autoLaunchDesc': 'Automatically start when you log in',
    'settings.autoLaunchOn': 'Auto-launch enabled',
    'settings.autoLaunchOff': 'Auto-launch disabled',
    'settings.update': 'Software update',
    'settings.upToDate': "You're up to date",
    'settings.checkUpdate': 'Check',
    'settings.checking': 'Checking...',
    'settings.newVersion': 'v{version} available',
    'settings.download': 'Download',
    'settings.downloadStarted': 'Download started in browser',
    'settings.downloadProgress': 'Downloading {percent}%',
    'settings.downloading': 'Downloading...',
    'settings.downloadComplete': 'Download complete',
    'settings.installRestart': 'Install & Restart',
    'settings.readyToInstall': 'Ready to install',
    'settings.installRestart': 'Install & Restart',
    'settings.updateError': 'Update check failed',
    'settings.devModeNoUpdate': 'Auto-update not available in dev mode',
    'settings.version': 'Version',
    'settings.language': 'Language',
    'settings.languageDesc': 'Interface language',
    'settings.terminal': 'Terminal',
    'settings.terminalDesc': 'Terminal for running commands',
    'settings.terminalSet': 'Terminal updated',
    'settings.shortcut': 'Global shortcut',
    'settings.shortcutDesc': 'Activate window from anywhere',
    'settings.pressKeys': 'Press keys...',
    'settings.shortcutSet': 'Shortcut registered',
    'settings.shortcutConflict': 'Shortcut already in use',
    'settings.shortcutFailed': 'Failed to register shortcut',
    'settings.shortcutCleared': 'Shortcut cleared',
    'settings.data': 'Data',
    'settings.dataDesc': 'Import or export project data',
    'settings.import': 'Import',
    'settings.export': 'Export',
    'settings.openDataDir': 'Open data folder',
    'settings.resetData': 'Reset all data',
    'settings.resetDataTitle': 'Reset Data',
    'settings.resetDataConfirm': 'This will delete all projects, schedules and settings. Are you sure?',
    'settings.resetDataDone': 'Data reset complete',
    'pin.pin': 'Pin',
    'pin.unpin': 'Unpin',
    'search.history': 'Search history',
    'search.clearHistory': 'Clear history',
    'url.title': 'URLs',
    'url.add': '+ Add URL',
    'url.name': 'Name',
    'url.url': 'URL',
    'url.open': 'Open in browser',
    'msg.imagePasted': 'Image pasted',
    'schedule.title': 'Schedule',
    'schedule.simple': 'Simple',
    'schedule.advanced': 'Advanced',
    'schedule.type': 'Type',
    'schedule.everyNMin': 'Every N minutes',
    'schedule.daily': 'Daily',
    'schedule.weekly': 'Weekly',
    'schedule.minutes': 'Minutes',
    'schedule.time': 'Time',
    'schedule.day': 'Day',
    'schedule.sun': 'Sun', 'schedule.mon': 'Mon', 'schedule.tue': 'Tue',
    'schedule.wed': 'Wed', 'schedule.thu': 'Thu', 'schedule.fri': 'Fri', 'schedule.sat': 'Sat',
    'schedule.notify': 'Notify on complete',
    'schedule.timeout': 'Timeout',
    'schedule.remove': 'Remove schedule',
    'schedule.saved': 'Schedule saved',
    'schedule.removed': 'Schedule removed',
    'schedule.enabled': 'Schedule enabled',
    'schedule.disabled': 'Schedule disabled',
    'schedule.enableToggle': 'Enable schedule',
    'schedule.saveFailed': 'Save failed',
    'schedule.cronHint': 'Format: minute hour day month weekday',
    'schedule.cronValid': 'Valid cron expression',
    'schedule.cronInvalid': 'Invalid cron expression',
    'logs.title': 'Schedule Logs',
    'logs.empty': 'No execution logs yet',
    'logs.total': '{count} log(s)',
    'logs.clearAll': 'Clear all',
    'logs.cleared': 'Logs cleared',
    'logs.noOutput': 'No output',
    'logs.manual': 'Manual',
    'logs.scheduled': 'Scheduled',
  },
  zh: {
    'sidebar.title': '项目',
    'sidebar.newProject': '新建项目 (⌘N)',
    'sidebar.search': '搜索项目...',
    'welcome.title': 'CC-Launcher',
    'welcome.subtitle': '选择一个项目或创建新项目',
    'welcome.shortcut': '添加项目',
    'welcome.activate': '激活窗口',
    'details.edit': '编辑',
    'details.delete': '删除',
    'details.projectPath': '项目路径',
    'details.outputPath': '输出路径',
    'details.open': '打开',
    'details.commands': '命令',
    'modal.newProject': '新建项目',
    'modal.editProject': '编辑项目',
    'modal.projectName': '项目名称',
    'modal.projectNamePlaceholder': '我的项目',
    'modal.projectPath': '项目路径',
    'modal.selectProjectFolder': '选择项目文件夹',
    'modal.browse': '浏览',
    'modal.commands': '命令',
    'modal.addCommand': '+ 添加命令',
    'modal.outputPath': '输出路径',
    'modal.selectOutputFolder': '选择输出文件夹（可选）',
    'modal.cancel': '取消',
    'modal.save': '保存',
    'modal.browseFile': '选择文件',
    'modal.cmdName': '命名',
    'details.cmdName': '命名',
    'action.run': '运行',
    'action.runSilent': '运行',
    'mode.terminal': '终端模式',
    'mode.silent': '静默模式',
    'mode.clickToTerminal': '当前静默模式 — 点击切换为终端模式',
    'mode.clickToSilent': '当前终端模式 — 点击切换为静默模式',
    'msg.loadFailed': '加载项目失败',
    'msg.noMatch': '没有匹配的项目',
    'msg.noProjects': '暂无项目',
    'msg.emptyCommand': '命令不能为空',
    'msg.fillAllFields': '请填写所有字段并添加至少一条命令',
    'msg.nameRequired': '项目名称不能为空',
    'msg.projectUpdated': '项目已更新',
    'msg.projectAdded': '项目已添加',
    'msg.saveFailed': '保存失败',
    'msg.deleteTitle': '删除项目',
    'msg.deleteConfirm': '确定要删除 "{name}" 吗？此操作不可撤销。',
    'msg.projectDeleted': '项目已删除',
    'msg.deleteFailed': '删除失败',
    'msg.launching': '正在启动终端...',
    'msg.launched': '命令已在终端中启动',
    'msg.executingSilent': '正在静默执行...',
    'msg.silentComplete': '执行完成，耗时 {duration}s',
    'msg.silentFailed': '静默执行失败',
    'msg.execFailed': '执行失败',
    'msg.exportFailed': '导出失败',
    'msg.exported': '设置已导出',
    'msg.invalidJson': '无效的 JSON 文件',
    'msg.imported': '已导入 {imported} 个，跳过 {skipped} 个',
    'msg.importFailed': '导入失败',
    'msg.minOneCommand': '至少需要一条命令',
    'confirm.cancel': '取消',
    'confirm.delete': '删除',
    'sidebar.settings': '设置',
    'settings.title': '设置',
    'settings.autoLaunch': '开机自启动',
    'settings.autoLaunchDesc': '登录系统时自动启动应用',
    'settings.autoLaunchOn': '已开启开机自启动',
    'settings.autoLaunchOff': '已关闭开机自启动',
    'settings.update': '软件更新',
    'settings.upToDate': '已是最新版本',
    'settings.checkUpdate': '检查更新',
    'settings.checking': '检查中...',
    'settings.newVersion': 'v{version} 可用',
    'settings.download': '下载',
    'settings.downloadStarted': '已在浏览器中开始下载',
    'settings.downloadProgress': '下载中 {percent}%',
    'settings.downloading': '下载中...',
    'settings.downloadComplete': '下载完成',
    'settings.installRestart': '安装并重启',
    'settings.readyToInstall': '准备安装',
    'settings.installRestart': '安装并重启',
    'settings.updateError': '检查更新失败',
    'settings.devModeNoUpdate': '开发模式下无法自动更新',
    'settings.version': '版本',
    'settings.language': '语言',
    'settings.languageDesc': '界面显示语言',
    'settings.terminal': '终端',
    'settings.terminalDesc': '执行命令使用的终端',
    'settings.terminalSet': '终端已更新',
    'settings.shortcut': '全局快捷键',
    'settings.shortcutDesc': '从任意位置激活窗口',
    'settings.pressKeys': '请按下快捷键...',
    'settings.shortcutSet': '快捷键已注册',
    'settings.shortcutConflict': '快捷键已被占用',
    'settings.shortcutFailed': '注册快捷键失败',
    'settings.shortcutCleared': '快捷键已清除',
    'settings.data': '数据',
    'settings.dataDesc': '导入或导出项目数据',
    'settings.import': '导入',
    'settings.export': '导出',
    'settings.openDataDir': '打开数据目录',
    'settings.resetData': '重置所有数据',
    'settings.resetDataTitle': '重置数据',
    'settings.resetDataConfirm': '这将删除所有项目、定时任务和设置，确定要继续吗？',
    'settings.resetDataDone': '数据已重置',
    'pin.pin': '置顶',
    'pin.unpin': '取消置顶',
    'search.history': '搜索历史',
    'search.clearHistory': '清除历史',
    'url.title': '网址',
    'url.add': '+ 添加网址',
    'url.name': '简称',
    'url.url': '网址',
    'url.open': '在浏览器中打开',
    'msg.imagePasted': '图片已粘贴',
    'schedule.title': '定时任务',
    'schedule.simple': '简单模式',
    'schedule.advanced': '高级模式',
    'schedule.type': '类型',
    'schedule.everyNMin': '每 N 分钟',
    'schedule.daily': '每天',
    'schedule.weekly': '每周',
    'schedule.minutes': '分钟',
    'schedule.time': '时间',
    'schedule.day': '星期',
    'schedule.sun': '日', 'schedule.mon': '一', 'schedule.tue': '二',
    'schedule.wed': '三', 'schedule.thu': '四', 'schedule.fri': '五', 'schedule.sat': '六',
    'schedule.notify': '完成后通知',
    'schedule.timeout': '超时',
    'schedule.remove': '移除定时',
    'schedule.saved': '定时任务已保存',
    'schedule.removed': '定时任务已移除',
    'schedule.enabled': '定时任务已启用',
    'schedule.disabled': '定时任务已暂停',
    'schedule.enableToggle': '启用定时任务',
    'schedule.saveFailed': '保存失败',
    'schedule.cronHint': '格式：分 时 日 月 周',
    'schedule.cronValid': 'Cron 表达式有效',
    'schedule.cronInvalid': 'Cron 表达式无效',
    'logs.title': '执行日志',
    'logs.empty': '暂无执行日志',
    'logs.total': '共 {count} 条',
    'logs.clearAll': '清空全部',
    'logs.cleared': '日志已清空',
    'logs.noOutput': '无输出',
    'logs.manual': '手动',
    'logs.scheduled': '定时',
  },
  ja: {
    'sidebar.title': 'プロジェクト',
    'sidebar.newProject': '新規プロジェクト (⌘N)',
    'sidebar.search': 'プロジェクトを検索...',
    'welcome.title': 'CC-Launcher',
    'welcome.subtitle': 'プロジェクトを選択するか、新規作成してください',
    'welcome.shortcut': 'プロジェクトを追加',
    'welcome.activate': 'ウィンドウをアクティブ化',
    'details.edit': '編集',
    'details.delete': '削除',
    'details.projectPath': 'プロジェクトパス',
    'details.outputPath': '出力パス',
    'details.open': '開く',
    'details.commands': 'コマンド',
    'modal.newProject': '新規プロジェクト',
    'modal.editProject': 'プロジェクトを編集',
    'modal.projectName': 'プロジェクト名',
    'modal.projectNamePlaceholder': 'マイプロジェクト',
    'modal.projectPath': 'プロジェクトパス',
    'modal.selectProjectFolder': 'プロジェクトフォルダを選択',
    'modal.browse': '参照',
    'modal.commands': 'コマンド',
    'modal.addCommand': '+ コマンドを追加',
    'modal.outputPath': '出力パス',
    'modal.selectOutputFolder': '出力フォルダを選択（任意）',
    'modal.cancel': 'キャンセル',
    'modal.save': '保存',
    'modal.browseFile': 'ファイルを選択',
    'modal.cmdName': '名前',
    'details.cmdName': '名前',
    'action.run': '実行',
    'action.runSilent': '実行',
    'mode.terminal': 'ターミナルモード',
    'mode.silent': 'サイレントモード',
    'mode.clickToTerminal': 'サイレントモード中 — クリックでターミナルモードに切替',
    'mode.clickToSilent': 'ターミナルモード中 — クリックでサイレントモードに切替',
    'msg.loadFailed': 'プロジェクトの読み込みに失敗',
    'msg.noMatch': '一致するプロジェクトがありません',
    'msg.noProjects': 'プロジェクトがありません',
    'msg.emptyCommand': 'コマンドを入力してください',
    'msg.fillAllFields': 'すべてのフィールドを入力し、少なくとも1つのコマンドを追加してください',
    'msg.nameRequired': 'プロジェクト名は必須です',
    'msg.projectUpdated': 'プロジェクトを更新しました',
    'msg.projectAdded': 'プロジェクトを追加しました',
    'msg.saveFailed': '保存に失敗しました',
    'msg.deleteTitle': 'プロジェクトを削除',
    'msg.deleteConfirm': '「{name}」を削除してもよろしいですか？この操作は取り消せません。',
    'msg.projectDeleted': 'プロジェクトを削除しました',
    'msg.deleteFailed': '削除に失敗しました',
    'msg.launching': 'ターミナルを起動中...',
    'msg.launched': 'ターミナルでコマンドを実行しました',
    'msg.executingSilent': 'サイレント実行中...',
    'msg.silentComplete': '{duration}秒で完了',
    'msg.silentFailed': 'サイレント実行に失敗',
    'msg.execFailed': '実行に失敗しました',
    'msg.exportFailed': 'エクスポートに失敗しました',
    'msg.exported': '設定をエクスポートしました',
    'msg.invalidJson': '無効なJSONファイルです',
    'msg.imported': '{imported}件インポート、{skipped}件スキップ',
    'msg.importFailed': 'インポートに失敗しました',
    'msg.minOneCommand': '少なくとも1つのコマンドが必要です',
    'confirm.cancel': 'キャンセル',
    'confirm.delete': '削除',
    'sidebar.settings': '設定',
    'settings.title': '設定',
    'settings.autoLaunch': 'ログイン時に起動',
    'settings.autoLaunchDesc': 'システムログイン時に自動起動',
    'settings.autoLaunchOn': '自動起動を有効にしました',
    'settings.autoLaunchOff': '自動起動を無効にしました',
    'settings.update': 'ソフトウェア更新',
    'settings.upToDate': '最新バージョンです',
    'settings.checkUpdate': '確認',
    'settings.checking': '確認中...',
    'settings.newVersion': 'v{version} が利用可能',
    'settings.download': 'ダウンロード',
    'settings.downloadStarted': 'ブラウザでダウンロード開始',
    'settings.downloadProgress': 'ダウンロード中 {percent}%',
    'settings.downloading': 'ダウンロード中...',
    'settings.downloadComplete': 'ダウンロード完了',
    'settings.installRestart': 'インストールして再起動',
    'settings.readyToInstall': 'インストール準備完了',
    'settings.installRestart': 'インストールして再起動',
    'settings.updateError': '更新確認に失敗',
    'settings.devModeNoUpdate': '開発モードでは自動更新不可',
    'settings.version': 'バージョン',
    'settings.language': '言語',
    'settings.languageDesc': 'インターフェース言語',
    'settings.terminal': 'ターミナル',
    'settings.terminalDesc': 'コマンド実行用ターミナル',
    'settings.terminalSet': 'ターミナルを更新しました',
    'settings.shortcut': 'グローバルショートカット',
    'settings.shortcutDesc': 'どこからでもウィンドウを表示',
    'settings.pressKeys': 'キーを押してください...',
    'settings.shortcutSet': 'ショートカットを登録しました',
    'settings.shortcutConflict': 'ショートカットは既に使用中です',
    'settings.shortcutFailed': 'ショートカットの登録に失敗',
    'settings.shortcutCleared': 'ショートカットをクリアしました',
    'settings.data': 'データ',
    'settings.dataDesc': 'プロジェクトデータのインポート・エクスポート',
    'settings.import': 'インポート',
    'settings.export': 'エクスポート',
    'settings.openDataDir': 'データフォルダを開く',
    'settings.resetData': 'すべてのデータをリセット',
    'settings.resetDataTitle': 'データリセット',
    'settings.resetDataConfirm': 'すべてのプロジェクト、スケジュール、設定が削除されます。よろしいですか？',
    'settings.resetDataDone': 'データをリセットしました',
    'pin.pin': 'ピン留め',
    'pin.unpin': 'ピン解除',
    'search.history': '検索履歴',
    'search.clearHistory': '履歴をクリア',
    'url.title': 'URL',
    'url.add': '+ URLを追加',
    'url.name': '名前',
    'url.url': 'URL',
    'url.open': 'ブラウザで開く',
    'msg.imagePasted': '画像を貼り付けました',
    'schedule.title': 'スケジュール',
    'schedule.simple': 'シンプル',
    'schedule.advanced': '詳細',
    'schedule.type': 'タイプ',
    'schedule.everyNMin': 'N分ごと',
    'schedule.daily': '毎日',
    'schedule.weekly': '毎週',
    'schedule.minutes': '分',
    'schedule.time': '時刻',
    'schedule.day': '曜日',
    'schedule.sun': '日', 'schedule.mon': '月', 'schedule.tue': '火',
    'schedule.wed': '水', 'schedule.thu': '木', 'schedule.fri': '金', 'schedule.sat': '土',
    'schedule.notify': '完了時に通知',
    'schedule.timeout': 'タイムアウト',
    'schedule.remove': 'スケジュールを削除',
    'schedule.saved': 'スケジュールを保存しました',
    'schedule.removed': 'スケジュールを削除しました',
    'schedule.enabled': 'スケジュールを有効にしました',
    'schedule.disabled': 'スケジュールを無効にしました',
    'schedule.enableToggle': 'スケジュールを有効にする',
    'schedule.saveFailed': '保存に失敗',
    'schedule.cronHint': '形式：分 時 日 月 曜日',
    'schedule.cronValid': '有効なcron式',
    'schedule.cronInvalid': '無効なcron式',
    'logs.title': '実行ログ',
    'logs.empty': '実行ログがありません',
    'logs.total': '{count}件のログ',
    'logs.clearAll': 'すべてクリア',
    'logs.cleared': 'ログをクリアしました',
    'logs.noOutput': '出力なし',
    'logs.manual': '手動',
    'logs.scheduled': 'スケジュール',
  },
  fr: {
    'sidebar.title': 'Projets',
    'sidebar.newProject': 'Nouveau projet (⌘N)',
    'sidebar.search': 'Rechercher des projets...',
    'welcome.title': 'CC-Launcher',
    'welcome.subtitle': 'Sélectionnez un projet ou créez-en un nouveau',
    'welcome.shortcut': 'pour ajouter un projet',
    'welcome.activate': 'pour activer la fenêtre',
    'details.edit': 'Modifier',
    'details.delete': 'Supprimer',
    'details.projectPath': 'Chemin du projet',
    'details.outputPath': 'Chemin de sortie',
    'details.open': 'Ouvrir',
    'details.commands': 'Commandes',
    'modal.newProject': 'Nouveau projet',
    'modal.editProject': 'Modifier le projet',
    'modal.projectName': 'Nom du projet',
    'modal.projectNamePlaceholder': 'Mon projet',
    'modal.projectPath': 'Chemin du projet',
    'modal.selectProjectFolder': 'Sélectionner le dossier du projet',
    'modal.browse': 'Parcourir',
    'modal.commands': 'Commandes',
    'modal.addCommand': '+ Ajouter une commande',
    'modal.outputPath': 'Chemin de sortie',
    'modal.selectOutputFolder': 'Sélectionner le dossier de sortie (optionnel)',
    'modal.cancel': 'Annuler',
    'modal.save': 'Enregistrer',
    'modal.browseFile': 'Parcourir fichier',
    'modal.cmdName': 'Nom',
    'details.cmdName': 'Nom',
    'action.run': 'Exécuter',
    'action.runSilent': 'Exécuter',
    'mode.terminal': 'Mode terminal',
    'mode.silent': 'Mode silencieux',
    'mode.clickToTerminal': 'Mode silencieux actif — cliquez pour passer en terminal',
    'mode.clickToSilent': 'Mode terminal actif — cliquez pour passer en silencieux',
    'msg.loadFailed': 'Échec du chargement des projets',
    'msg.noMatch': 'Aucun projet correspondant',
    'msg.noProjects': 'Aucun projet pour le moment',
    'msg.emptyCommand': 'La commande ne peut pas être vide',
    'msg.fillAllFields': 'Veuillez remplir tous les champs et ajouter au moins une commande',
    'msg.nameRequired': 'Le nom du projet est requis',
    'msg.projectUpdated': 'Projet mis à jour',
    'msg.projectAdded': 'Projet ajouté',
    'msg.saveFailed': 'Échec de la sauvegarde',
    'msg.deleteTitle': 'Supprimer le projet',
    'msg.deleteConfirm': 'Êtes-vous sûr de vouloir supprimer « {name} » ? Cette action est irréversible.',
    'msg.projectDeleted': 'Projet supprimé',
    'msg.deleteFailed': 'Échec de la suppression',
    'msg.launching': 'Lancement du terminal...',
    'msg.launched': 'Commande lancée dans le terminal',
    'msg.executingSilent': 'Exécution silencieuse...',
    'msg.silentComplete': 'Terminé en {duration}s',
    'msg.silentFailed': "Échec de l'exécution silencieuse",
    'msg.execFailed': "Échec de l'exécution",
    'msg.exportFailed': "Échec de l'exportation",
    'msg.exported': 'Paramètres exportés',
    'msg.invalidJson': 'Fichier JSON invalide',
    'msg.imported': '{imported} importé(s), {skipped} ignoré(s)',
    'msg.importFailed': "Échec de l'importation",
    'msg.minOneCommand': 'Au moins une commande est requise',
    'confirm.cancel': 'Annuler',
    'confirm.delete': 'Supprimer',
    'sidebar.settings': 'Paramètres',
    'settings.title': 'Paramètres',
    'settings.autoLaunch': 'Lancer au démarrage',
    'settings.autoLaunchDesc': 'Démarrer automatiquement à la connexion',
    'settings.autoLaunchOn': 'Lancement automatique activé',
    'settings.autoLaunchOff': 'Lancement automatique désactivé',
    'settings.update': 'Mise à jour',
    'settings.upToDate': 'Vous êtes à jour',
    'settings.checkUpdate': 'Vérifier',
    'settings.checking': 'Vérification...',
    'settings.newVersion': 'v{version} disponible',
    'settings.download': 'Télécharger',
    'settings.downloadStarted': 'Téléchargement lancé dans le navigateur',
    'settings.downloadProgress': 'Téléchargement {percent}%',
    'settings.downloading': 'Téléchargement...',
    'settings.downloadComplete': 'Téléchargement terminé',
    'settings.installRestart': 'Installer et redémarrer',
    'settings.readyToInstall': "Prêt à installer",
    'settings.installRestart': 'Installer et redémarrer',
    'settings.updateError': 'Échec de la vérification',
    'settings.devModeNoUpdate': 'Mise à jour non disponible en mode dev',
    'settings.version': 'Version',
    'settings.language': 'Langue',
    'settings.languageDesc': "Langue de l'interface",
    'settings.terminal': 'Terminal',
    'settings.terminalDesc': 'Terminal pour exécuter les commandes',
    'settings.terminalSet': 'Terminal mis à jour',
    'settings.shortcut': 'Raccourci global',
    'settings.shortcutDesc': "Activer la fenêtre depuis n'importe où",
    'settings.pressKeys': 'Appuyez sur les touches...',
    'settings.shortcutSet': 'Raccourci enregistré',
    'settings.shortcutConflict': 'Raccourci déjà utilisé',
    'settings.shortcutFailed': "Échec de l'enregistrement du raccourci",
    'settings.shortcutCleared': 'Raccourci effacé',
    'settings.data': 'Données',
    'settings.dataDesc': 'Importer ou exporter les données de projet',
    'settings.import': 'Importer',
    'settings.export': 'Exporter',
    'settings.openDataDir': 'Ouvrir le dossier de données',
    'settings.resetData': 'Réinitialiser toutes les données',
    'settings.resetDataTitle': 'Réinitialiser les données',
    'settings.resetDataConfirm': 'Cela supprimera tous les projets, planifications et paramètres. Êtes-vous sûr ?',
    'settings.resetDataDone': 'Données réinitialisées',
    'pin.pin': 'Épingler',
    'pin.unpin': 'Désépingler',
    'search.history': 'Historique de recherche',
    'search.clearHistory': "Effacer l'historique",
    'url.title': 'URL',
    'url.add': '+ Ajouter URL',
    'url.name': 'Nom',
    'url.url': 'URL',
    'url.open': 'Ouvrir dans le navigateur',
    'msg.imagePasted': 'Image collée',
    'schedule.title': 'Planifier',
    'schedule.simple': 'Simple',
    'schedule.advanced': 'Avancé',
    'schedule.type': 'Type',
    'schedule.everyNMin': 'Toutes les N minutes',
    'schedule.daily': 'Quotidien',
    'schedule.weekly': 'Hebdomadaire',
    'schedule.minutes': 'Minutes',
    'schedule.time': 'Heure',
    'schedule.day': 'Jour',
    'schedule.sun': 'Dim', 'schedule.mon': 'Lun', 'schedule.tue': 'Mar',
    'schedule.wed': 'Mer', 'schedule.thu': 'Jeu', 'schedule.fri': 'Ven', 'schedule.sat': 'Sam',
    'schedule.notify': 'Notifier à la fin',
    'schedule.timeout': 'Délai max',
    'schedule.remove': 'Supprimer la planification',
    'schedule.saved': 'Planification enregistrée',
    'schedule.removed': 'Planification supprimée',
    'schedule.enabled': 'Planification activée',
    'schedule.disabled': 'Planification désactivée',
    'schedule.enableToggle': 'Activer la planification',
    'schedule.saveFailed': 'Échec de la sauvegarde',
    'schedule.cronHint': 'Format : minute heure jour mois jour_semaine',
    'schedule.cronValid': 'Expression cron valide',
    'schedule.cronInvalid': 'Expression cron invalide',
    'logs.title': 'Journaux',
    'logs.empty': "Aucun journal d'exécution",
    'logs.total': '{count} entrée(s)',
    'logs.clearAll': 'Tout effacer',
    'logs.cleared': 'Journaux effacés',
    'logs.noOutput': 'Pas de sortie',
    'logs.manual': 'Manuel',
    'logs.scheduled': 'Planifié',
  },
};

const SUPPORTED_LOCALES = ['en', 'zh', 'ja', 'fr'];
const LOCALE_LABELS = { en: 'English', zh: '中文', ja: '日本語', fr: 'Français' };

// Translate a key with optional parameter interpolation
function t(key, params = {}) {
  const dict = translations[currentLocale] || translations.en;
  let text = dict[key] || translations.en[key] || key;
  for (const [k, v] of Object.entries(params)) {
    text = text.replace(`{${k}}`, v);
  }
  return text;
}

// Apply translations to all elements with data-i18n attributes
function applyLocale() {
  document.querySelectorAll('[data-i18n]').forEach((el) => {
    el.textContent = t(el.dataset.i18n);
  });
  document.querySelectorAll('[data-i18n-placeholder]').forEach((el) => {
    el.placeholder = t(el.dataset.i18nPlaceholder);
  });
  document.querySelectorAll('[data-i18n-title]').forEach((el) => {
    el.title = t(el.dataset.i18nTitle);
  });
  document.documentElement.lang = currentLocale === 'zh' ? 'zh-CN' : currentLocale;
}

// Set locale and persist
async function setLocale(locale) {
  if (!SUPPORTED_LOCALES.includes(locale)) return;
  currentLocale = locale;
  applyLocale();
  if (window.electronAPI?.setLocale) {
    await window.electronAPI.setLocale(locale);
  }
}

// Initialize locale from persisted setting or system
async function initLocale() {
  if (window.electronAPI?.getLocale) {
    const saved = await window.electronAPI.getLocale();
    if (saved && SUPPORTED_LOCALES.includes(saved)) {
      currentLocale = saved;
      applyLocale();
      return;
    }
  }
  // Fallback: detect from navigator
  const sysLang = (navigator.language || 'en').slice(0, 2);
  currentLocale = SUPPORTED_LOCALES.includes(sysLang) ? sysLang : 'en';
  applyLocale();
}